<!-- templates/importation/accueil.html -->
{% extends "base.html" %}

{% block title %}Importation des transcriptions{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">Système d'importation des transcriptions</h1>
    
    <div class="alert alert-info">
        <p>Ce module permet d'importer les données transcrites à partir des fiches manuscrites scannées vers la base de données principale.</p>
        <p>Processus d'importation:</p>
        <ol>
            <li>Importer les fichiers JSON</li>
            <li>Extraire les espèces et observateurs candidats</li>
            <li>Valider les correspondances</li>
            <li>Préparer les importations</li>
            <li>Finaliser les importations</li>
        </ol>
    </div>
    <!-- Ajout du bouton pour voir le résumé des importations -->
    <div class="mb-4">
        <a href="{% url 'resume_importation' %}" class="btn btn-info">
            <i class="fas fa-chart-bar"></i> Voir le résumé des importations
        </a>
    </div>
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Transcriptions</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-2">
                        <span>Total:</span>
                        <strong>{{ total_transcriptions }}</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Traitées:</span>
                        <strong>{{ transcriptions_traitees }}</strong>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>En attente:</span>
                        <strong>{{ total_transcriptions|add:"-"|add:transcriptions_traitees }}</strong>
                    </div>
                    
                    <div class="mt-3">
                        <a href="{% url 'importer_json' %}" class="btn btn-primary">Importer des fichiers JSON</a>
                        <a href="{% url 'extraire_candidats' %}" class="btn btn-secondary">Extraire les candidats</a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">Réconciliation</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-2">
                        <span>Espèces candidates:</span>
                        <strong>{{ especes_candidates }}</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Espèces validées:</span>
                        <strong>{{ especes_validees }}</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-3">
                        <span>Espèces en attente:</span>
                        <strong>{{ especes_candidates|add:"-"|add:especes_validees }}</strong>
                    </div>
                    
                    <div class="d-flex justify-content-between mb-2">
                        <span>Observateurs candidats:</span>
                        <strong>{{ observateurs_candidats }}</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Observateurs validés:</span>
                        <strong>{{ observateurs_valides }}</strong>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>Observateurs en attente:</span>
                        <strong>{{ observateurs_candidats|add:"-"|add:observateurs_valides }}</strong>
                    </div>
                    
                    <div class="mt-3">
                        <a href="{% url 'liste_especes_candidates' %}" class="btn btn-success">Gérer les espèces</a>
                        <a href="{% url 'liste_observateurs_candidats' %}" class="btn btn-success">Gérer les observateurs</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">Importations</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-2">
                        <span>En attente:</span>
                        <strong>{{ importations_en_attente }}</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>En erreur:</span>
                        <strong>{{ importations_erreur }}</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-3">
                        <span>Terminées:</span>
                        <strong>{{ importations_completees }}</strong>
                    </div>
                    
                    <div class="mt-3">
                        <a href="{% url 'preparer_importations' %}" class="btn btn-info">Préparer les importations</a>
                        <a href="{% url 'liste_importations' %}" class="btn btn-info">Gérer les importations</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
