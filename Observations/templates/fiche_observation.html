{% extends "base.html" %}

{% block content %}
<h2>Fiche Observation n°{{ fiche.num_fiche }}</h2>

<table>
    <tr>
        <th>Numéro</th>
        <th>Observateur</th>
        <th>Espèce</th>
        <th>Date de création</th>
        <th>Année</th>
        <th>Image</th>
    </tr>
    <tr>
        <td>{{ fiche.num_fiche }}</td>
        <td>{{ fiche.observateur.prenom }} {{ fiche.observateur.nom }}</td>
        <td>{{ fiche.espece.nom }}</td>
        <td>{{ fiche.date_creation|date:"d/m/Y" }}</td>
        <td>{{ fiche.annee }}</td>
        <td>
            {% if fiche.chemin_image %}
                <a href="{{ fiche.chemin_image }}" target="_blank">Voir l'image</a>
            {% else %}
                Pas d'image
            {% endif %}
        </td>
    </tr>
</table>

<h3>Localisation</h3>
<table>
    <tr><th>Commune</th><td>{{ localisation.commune }}</td></tr>
    <tr><th>Département</th><td>{{ localisation.departement }}</td></tr>
    <tr><th>Coordonnées</th><td>{{ localisation.coordonnees }}</td></tr>
    <tr><th>Latitude</th><td>{{ localisation.latitude }}</td></tr>
    <tr><th>Longitude</th><td>{{ localisation.longitude }}</td></tr>
    <tr><th>Altitude</th><td>{{ localisation.altitude }}</td></tr>
    <tr><th>Paysage</th><td>{{ localisation.paysage }}</td></tr>
    <tr><th>Alentours</th><td>{{ localisation.alentours }}</td></tr>
</table>

<h3>Observations</h3>
    {% include "observations/fiche_observation/observation_table.html" with observations=fiche.observations.all %}

    <h3>Détails du Nid</h3>
    {% if nid %}
        {% include "observations/fiche_observation/nid_detail.html" with fiche=fiche %}
    {% else %}
        <p>Aucun nid trouvé pour cette fiche.</p>
    {% endif %}

    <h3>Résumé de l'observation</h3>
    {% if resume %}
        {% include "observations/fiche_observation/resume_observation.html" %}
    {% else %}
        <p>Aucun résumé d'observation disponible.</p>
    {% endif %}

    <h3>Causes de l'échec</h3>
    {% if causes_echec %}
        {% include "observations/fiche_observation/causes_echec.html" with fiche=fiche %}
    {% else %}
        <p>Aucune cause d'échec enregistrée.</p>
    {% endif %}

    <h3>Remarques</h3>
    {% if fiche.remarques.all %}
        {% include "observations/fiche_observation/remarques_table.html" with remarques=fiche.remarques.all %}
    {% else %}
        <p>Aucune remarque enregistrée.</p>
    {% endif %}

{% endblock %}
