{% extends "base.html" %}

{% block content %}
<h2>Fiche Observation n°{{ fiche.num_fiche }}</h2>

<table class="fiche-table">
    <tr>
        <th>N° Fiche</th>
        <th>Observateur</th>
        <th>N°</th>
        <th>Espèce</th>
        <th>Année</th>
    </tr>
    <tr>
        <td>{{ fiche.num_fiche }}</td>
        <td>{{ fiche.observateur.prenom }} {{ fiche.observateur.nom }}</td>
        <td>{{ fiche.espece.nom }}</td>
        <td>{{ fiche.espece.nom }}</td>
        <td>{{ fiche.annee }}</td>
    </tr>
</table>

<h3>Localisation</h3>
<h3>Localisation</h3>

<div class="localisation-container">
    <!-- Partie gauche : Localisation + Observations -->
    <div class="localisation-left">
        <table class="localisation-table">
            <tr>
                <th>Commune</th>
                <td>{{ localisation.commune }}</td>
                <th>Département</th>
                <td>{{ localisation.departement }}</td>
            </tr>
            <tr>
                <th>Lieu-dit</th>
                <td>{{ localisation.lieu_dit }}</td>
                <th>Altitude</th>
                <td>{{ localisation.altitude }}</td>
            </tr>
            <tr>
                <th>Latitude</th>
                <td>{{ localisation.latitude }}</td>
                <th>Longitude</th>
                <td>{{ localisation.longitude }}</td>
            </tr>
        </table>

        <!-- Tableau des observations sous Localisation -->
        <h3>Observations</h3>
        <div class="observations-table">
            {% include "observations/fiche_observation/observation_table.html" with observations=fiche.observations.all %}
        </div>
    </div>

    <!-- Partie droite : Paysage & Alentours -->
    <div class="localisation-right">
        <div class="section-title">Paysage (200 à 500m)</div>
        <div class="section-content">{{ localisation.paysage }}</div>

        <div class="section-title">Alentours (20 à 50m)</div>
        <div class="section-content">{{ localisation.alentours }}</div>
    </div>
</div>

    <h3>Détails du Nid</h3>
    {% if nid %}
        {% include "observations/fiche_observation/nid_detail.html" with fiche=fiche %}
    {% else %}
        <p>Aucun nid trouvé pour cette fiche.</p>
    {% endif %}

    <h3>Résumé de l'observation</h3>
    {% if resume %}
        {% include "observations/fiche_observation/resume_observation.html" %}
    {% else %}
        <p>Aucun résumé d'observation disponible.</p>
    {% endif %}

    <h3>Causes de l'échec</h3>
    {% if causes_echec %}
        {% include "observations/fiche_observation/causes_echec.html" with fiche=fiche %}
    {% else %}
        <p>Aucune cause d'échec enregistrée.</p>
    {% endif %}

    <h3>Remarques</h3>
    {% if fiche.remarques.all %}
        {% include "observations/fiche_observation/remarques_table.html" with remarques=fiche.remarques.all %}
    {% else %}
        <p>Aucune remarque enregistrée.</p>
    {% endif %}

{% endblock %}
