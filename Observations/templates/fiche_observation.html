{% extends "base.html" %}

{% block content %}
<h2>Fiche Observation n°{{ fiche.num_fiche }}</h2>

<table class="fiche-table">
    <tr>
        <th>N° Fiche</th>
        <th>Observateur</th>
        <th>N°</th>
        <th>Espèce</th>
        <th>Année</th>
    </tr>
    <tr>
        <td>{{ fiche.num_fiche }}</td>
        <td>{{ fiche.observateur.prenom }} {{ fiche.observateur.nom }}</td>
        <td>{{ fiche.espece.nom }}</td>
        <td>{{ fiche.espece.nom }}</td>
        <td>{{ fiche.annee }}</td>
    </tr>
</table>

<h3>Localisation</h3>

<div class="localisation-container">
    <!-- Partie gauche : Localisation + Observations + Nid -->
    <div class="localisation-left">
        <table class="localisation-table">
            <tr>
                <th>Commune</th>
                <td>{{ localisation.commune }}</td>
                <th>Département</th>
                <td>{{ localisation.departement }}</td>
            </tr>
            <tr>
                <th>Lieu-dit</th>
                <td>{{ localisation.lieu_dit }}</td>
                <th>Altitude</th>
                <td>{{ localisation.altitude }}</td>
            </tr>
            <tr>
                <th>Latitude</th>
                <td>{{ localisation.latitude }}</td>
                <th>Longitude</th>
                <td>{{ localisation.longitude }}</td>
            </tr>
        </table>

        <!-- Tableau pour les informations du nid -->
        <h3>Détails du Nid</h3>
        <table class="nid-table">
            <tr>
                <th>Utilisé par le même couple</th>
                <th>Hauteur du nid (cm)</th>
                <th>Hauteur du couvert (cm)</th>
            </tr>
            <tr>
                <td>{% if fiche.nid.nid_prec_t_meme_couple %}Oui{% else %}Non{% endif %}</td>
                <td>{{ fiche.nid.hauteur_nid }}</td>
                <td>{{ fiche.nid.hauteur_couvert }}</td>
            </tr>
        </table>

        <!-- Tableau des observations sous Localisation -->
        <h3>Observations</h3>
        <div class="observations-table">
            {% include "observations/fiche_observation/observation_table.html" with observations=fiche.observations.all %}
        </div>
    </div>

    <!-- Partie droite : Paysage & Alentours -->
    <div class="localisation-right">
        <div class="section-title">Paysage (200 à 500m)</div>
        <div class="section-content">{{ localisation.paysage }}</div>

        <div class="section-title">Alentours (20 à 50m)</div>
        <div class="section-content">{{ localisation.alentours }}</div>


        <!-- Section Détails du Nid sous forme de cadre -->
        <div class="section-title">Détails du Nid</div>
        <div class="section-content">{{ fiche.nid.details_nid }}</div>
    </div>
</div>

<!-- Résumé de l'observation en pleine largeur -->
<div class="resume-container">
    <h3>Résumé de l'observation</h3>
    {% if resume %}
        {% include "observations/fiche_observation/resume_observation.html" %}
    {% else %}
        <p>Aucun résumé d'observation disponible.</p>
    {% endif %}
</div>
<!-- Conteneur pour Causes de l'échec et Remarques -->
<div class="causes-remarques-container">
    <!-- Partie gauche : Causes de l'échec -->
    <div class="causes-container">
        <h3>Description des causes d'échec</h3>
        {% if causes_echec %}
            {% include "observations/fiche_observation/causes_echec.html" with fiche=fiche %}
        {% else %}
            <p>Aucune cause d'échec enregistrée.</p>
        {% endif %}
    </div>

    <!-- Partie droite : Remarques -->
    <div class="remarques-container">
        {% if fiche.remarques.all %}
            {% include "observations/fiche_observation/remarques_table.html" with remarques=fiche.remarques.all %}
        {% else %}
            <p>Aucune remarque enregistrée.</p>
        {% endif %}
    </div>
</div>


{% endblock %}
